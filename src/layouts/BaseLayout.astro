---
import "../styles/global.css";

interface Props {
    lang: string;
    title: string;
    description: string;
    footerText: string;
}

const { lang, title, description, footerText } = Astro.props;
---

<html lang={lang} class="scroll-smooth">
    <head>
        <meta charset="utf-8" />
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <link rel="icon" href="/favicon.ico" />
        <meta name="viewport" content="width=device-width" />
        <meta name="generator" content={Astro.generator} />
        <meta name="description" content={description} />
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;500;600;700;800&display=swap"
            rel="stylesheet"
        />
        <title>{title}</title>
        <script is:inline>
            const storedTheme = localStorage.getItem("theme");
            if (
                storedTheme === "dark" ||
                (!storedTheme &&
                    window.matchMedia("(prefers-color-scheme: dark)").matches)
            ) {
                document.documentElement.classList.add("dark");
            } else {
                document.documentElement.classList.remove("dark");
            }
        </script>
    </head>
    <body
        class="min-h-screen bg-zinc-50 font-['Sora'] text-zinc-800 antialiased transition-colors duration-300 dark:bg-violet-950 dark:shadow-[0_0_20px_rgba(217,70,239,0.36)] dark:text-violet-100"
    >
        <div class="pointer-events-none fixed inset-0 -z-10 overflow-hidden">
            <div
                class="absolute left-[10%] top-[4%] h-[360px] w-[360px] rounded-full bg-fuchsia-400/25 blur-3xl dark:bg-fuchsia-400/30"
            >
            </div>
            <div
                class="absolute right-[6%] top-[8%] h-[340px] w-[340px] rounded-full bg-violet-500/20 blur-3xl dark:bg-violet-400/30"
            >
            </div>
            <div
                class="absolute inset-0 bg-gradient-to-b from-violet-50/50 via-zinc-50 to-zinc-50 dark:from-[#191322] dark:via-[#13131a] dark:to-[#111116]"
            >
            </div>
        </div>

        <slot />

        <footer
            class="pb-11 pt-9 text-center text-sm text-zinc-600 dark:text-violet-400"
        >
            <div class="mx-auto w-[min(1120px,92vw)]">{footerText}</div>
        </footer>

        <script is:inline>
            const root = document.documentElement;
            const themeSlider = document.getElementById("theme-slider");
            const themeOptions = document.querySelectorAll(
                "[data-theme-option]",
            );
            const reduceMotion = window.matchMedia(
                "(prefers-reduced-motion: reduce)",
            ).matches;

            const setTheme = (mode) => {
                root.classList.toggle("dark", mode === "dark");
                localStorage.setItem("theme", mode);
                themeSlider?.classList.toggle(
                    "translate-x-10",
                    mode === "dark",
                );
                themeOptions.forEach((option) => {
                    const isActive = option.getAttribute("data-theme") === mode;
                    option.classList.toggle("text-white", isActive);
                    option.classList.toggle("text-zinc-700", !isActive);
                    option.classList.toggle("dark:text-violet-200", !isActive);
                });
            };

            setTheme(root.classList.contains("dark") ? "dark" : "light");

            themeOptions.forEach((option) => {
                option.addEventListener("click", () => {
                    const targetTheme = option.getAttribute("data-theme");
                    if (!targetTheme) return;
                    const currentTheme = root.classList.contains("dark")
                        ? "dark"
                        : "light";
                    if (targetTheme === currentTheme) return;
                    setTheme(targetTheme);
                });
            });

            const langSlider = document.getElementById("lang-slider");
            const langLinks = document.querySelectorAll("[data-lang-link]");
            const activeLang = (root.lang || "es").startsWith("en")
                ? "en"
                : "es";

            langLinks.forEach((link) => {
                link.addEventListener("click", (event) => {
                    const nextLang = link.getAttribute("data-lang");
                    if (!nextLang || nextLang === activeLang) return;
                    event.preventDefault();
                    langSlider?.classList.toggle(
                        "translate-x-10",
                        nextLang === "en",
                    );
                    const targetUrl = link.getAttribute("href");
                    const delay = reduceMotion ? 0 : 220;
                    window.setTimeout(() => {
                        if (targetUrl) window.location.href = targetUrl;
                    }, delay);
                });
            });
        </script>
    </body>
</html>
